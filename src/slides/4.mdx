# Git
#### Chapitre 4

---

# Les opérations de branch

* reset
* cherry-pick
* merge
* rebase

---

## Reset

* permet de remettre le pointeur d'une branche sur un certain commit
* les modifications peuvent être concervés sur le working directory (soft)
* les modifications peuvent être supprimés (hard)

---

## Reset

```sh
git reset master
git reset --hard master
```

---

## Cherry-pick

* permet de récupérer des commits sur la branche courante
* les commits sont dupliqués
* la branche courante progresse
* risque de conflits
* en cas de conflits, la résolution se trouve dans le commit récupéré
* si le commit est vide (pas de diff car le code est déjà présent), il est ignoré

---

## Cherry-pick

```sh
git cherry-pick toto ad123edf
```

---

import CherryPick from '../components/repos/cherryPick'

<CherryPick />

---

## Merge

* permet de fusioner des branches
* notion de fast-forward
* si fast-forward, déplace simplement la branche courante
* si non fast-forward, crée un commit avec plusieurs parents
  (commit de merge)
* risque de conflits
* en cas de conflits, la résolution se trouve dans le commit de merge

---

## Merge

```sh
git merge foo
git merge foo --ff-only
git merge foo --no-ff
```

---

import MergeFf from '../components/repos/mergeff';

<MergeFf />

---

import Merge from '../components/repos/merge';

<Merge />

---

## Rebase

* déplace une branche
* tous les commits sont dupliqués à leur nouvelle position
  (car immuables)
* risque de conflits
* en cas de conflits, la résolution se trouve dans le commit récupéré
* si le commit est vide (pas de diff car le code est déjà présent), il est ignoré

---

## Rebase

```sh
git rebase foo
git rebase foo -i
git rebase foo -i --autosqash
git rebase --onto foo HEAD~2 bar
```
---

import Rebase from '../components/repos/rebase';

<Rebase />

---

import RebaseOnto from '../components/repos/rebaseOnto';

<RebaseOnto />

---

## TP 4

* faire un reset de master sur le premier commit du repo
* créer une branche A sur master et faire un cherry-pick du dernier commit de la branche précédente

---

## TP 4

* ajouter un nouveau fichier avec du contenu sur une nouvelle branche B basée sur master
* merger la branche A dans la branche B
* créer un branche C sur master, et créer le même fichier que la branche B mais avec un contenu différent
* merger B dans C

---

## TP 4

* à l'aide de la commande reset supprimer le dernier commit de la branch B tout en gardant le contenu
* remettre les branche B et C à leur état avant les merges de l'exercice précédent

---

## TP 4

* faire un rebase de B sur A
* faire un rebase de C sur B
* faire un rebase de C sur master sans embarquer les commits de B 

